---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# astr

<!-- badges: start -->
<!-- badges: end -->

The goal of astr is to make working with Access Sensor Technologies (AST) air sampler log files easy.

## Installation

The `astr` package can be installed from our [GitHub](https://github.com/accsensors/astr).
You must have the `devtools` package installed.
Use the following commands to install the `devtools` and `astr` packages.

``` r
install.packages("devtools")
devtools::install_github("accsensors/astr")
```
## Reading Air Sampler Log Files into R

Once the astr package has been installed, you can load the package using the following command:

```{r load_pkg}
library(astr)
```

Two functions are used to read log files into R: read_ast_header and read_ast_log. 
These functions work for UPASv2, UPASv2x, and Home Health Box (HHB) log files.
To view the documentation for these two functions, use either of the following commands:
```{r documentation}
?read_ast_header
?read_ast_log
```

To read the header data from multiple UPAS log files and create a data frame with one row for each file: 

```{r header}
data_upas_h <- list.files(path = ".", pattern="^PS.*.txt$",  full.names = TRUE)%>%
  lapply(read_ast_header, update_names = TRUE)%>%
  dplyr::bind_rows()
```

To read the sample logs from multiple UPAS log files and combine them all into a single data frame: 

```{r log}
data_upas <- list.files(path = ".", pattern="^PS.*.txt$",  full.names = TRUE)%>%
  lapply(read_ast_log, update_names = TRUE)%>%
  dplyr::bind_rows()
```

For the examples above, you will need to update the `path` argument in the `list.files` function to indicate the location where your log files are stored, relative to your working directory. Specifying `pattern = "^PS.*.txt$"`, will choose only UPAS log files, since UPASv2 and UPASv2x log files are prefixed by `"PS"` and `"PSP"` respectively. To read only UPASv2, UPASv2x, or HHB files edit the `pattern` argument in `list.files` as shown below:

```{r specific_files}
# UPASv2 files
data_upasv2 <- list.files(path = ".", pattern="^PS[1-9].*.txt$",  full.names = TRUE)%>%
  lapply(read_ast_log, update_names = FALSE)%>%
  dplyr::bind_rows()

# UPASv2x files
data_upasv2x <- list.files(path = ".", pattern="^PSP.*.txt$",  full.names = TRUE)%>%
  lapply(read_ast_log, update_names = FALSE)%>%
  dplyr::bind_rows()

# HHB files
data_hhb <- list.files(path = ".", pattern="^HHB.*.csv$",  full.names = TRUE)%>%
  lapply(read_ast_log, update_names = TRUE)%>%
  dplyr::bind_rows()
```

This package also includes many example log files to test your scripts. To see a list of the example log files included with this package, use the command below:

```{r example_files}
example_files <- system.file("extdata", package = "astr", mustWork = TRUE) |>
    list.files(pattern=NULL, full.names = TRUE)
```

You will notice there are log files for UPASv2 (prefixed by `"PS"`), UPASv2x (prefixed by `"PSP"`), and HHB (prefixed by `"HHB"`). 
Use the commands below to generate example data frames using the example UPAS log files. Change the `pattern` argument in `list.files` as previously described to select the types of log file read (e.g. `pattern = "^HHB.*.csv$"` for HHB log files.

```{r example_header}
data_upas_examples_h <- system.file("extdata", package = "astr", mustWork = TRUE) |>
    list.files(pattern="^PS.*.txt$", full.names = TRUE) %>%
    lapply(read_ast_header, update_names = TRUE) %>%
    dplyr::bind_rows()
```


```{r example_log}
data_upas_examples <- system.file("extdata", package = "astr", mustWork = TRUE) |>
    list.files(pattern="^PS.*.txt$", full.names = TRUE) %>%
    lapply(read_ast_log, update_names = TRUE) %>%
    dplyr::bind_rows()
```

Describe the other functions
Describe shiny functions and recommendations for use
Describe map functions and maybe show example
Edit the read_ast_log and read_ast_header documentation to also specify some of the extra info stated here
